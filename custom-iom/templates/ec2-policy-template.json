{
  "name": "EC2 Instance Required Tags Policy",
  "description": "Custom IOM to ensure EC2 instances have required management and security tags for proper governance, cost tracking, and operational visibility",
  "platform": "AWS",
  "provider": "AWS",
  "resource_type": "AWS::EC2::Instance",
  "domain": "CSPM",
  "subdomain": "IOM",
  "severity": 2,
  "logic": "package crowdstrike\\n\\ndefault result := \\"fail\\"\\n\\n# Required tags for compliance\\nrequired_tags := [\\"Environment\\", \\"Owner\\", \\"Project\\"]\\n\\n# Helper function to check if tag exists and has value\\nhas_tag(tag_name) if {\\n    input.tags[tag_name]\\n    input.tags[tag_name] != \\"\\"\\n}\\n\\n# Pass if all required tags are present and instance is active\\nresult := \\"pass\\" if {\\n    input.active == true\\n    count([tag | tag := required_tags[_]; has_tag(tag)]) == count(required_tags)\\n    input.tags[\\"Environment\\"] in [\\"dev\\", \\"staging\\", \\"prod\\", \\"test\\"]\\n}",
  "alert_info": "EC2 instance is missing required tags for proper resource management, cost tracking, and operational governance",
  "remediation_info": "Navigate to AWS EC2 console|Select the non-compliant instance|Click Tags tab and select Manage tags|Add missing required tags: Environment (dev/staging/prod/test), Owner (team or individual responsible), Project (associated project name)|Ensure tag values follow organizational naming conventions|Click Save changes to apply tags|Update any automation or billing reports to include new tags",
  "attack_types": "Misconfiguration"
}
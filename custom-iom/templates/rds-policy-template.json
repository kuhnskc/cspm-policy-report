{
  "name": "AWS RDS Comprehensive Security Compliance",
  "description": "Advanced Custom IOM for AWS RDS instances ensuring comprehensive security controls including encryption, network security, backup policies, version management, monitoring, high availability, and cost optimization",
  "platform": "AWS",
  "provider": "AWS",
  "resource_type": "AWS::RDS::DBInstance",
  "domain": "CSPM",
  "subdomain": "IOM",
  "severity": 1,
  "logic": "package crowdstrike\\n\\ndefault result := \\"fail\\"\\n\\n# Helper functions\\nhas_tag(tag_name) if {\\n    input.tags[tag_name]\\n    input.tags[tag_name] != \\\"\\\"\\n}\\n\\ndatabase_port_exposed(port) if {\\n    port in [3306, 5432, 1433, 1521, 27017, 6379]\\n}\\n\\n# Main compliance check - all critical security requirements must pass\\nresult := \\"pass\\" if {\\n    input.resource_type == \\"AWS::RDS::DBInstance\\"\\n    input.active == true\\n    \\n    # 1. Encryption Requirements\\n    input.cloud_context.storage_encrypted == true\\n    \\n    # 2. Network Security\\n    input.cloud_context.publicly_accessible == false\\n    not wide_open_database_access\\n    \\n    # 3. Backup Configuration\\n    input.cloud_context.backup_retention_period > 0\\n    backup_retention_appropriate\\n    \\n    # 4. Version Management\\n    input.cloud_context.auto_minor_version_upgrade == true\\n    input.cloud_context.maintenance_window != \\\"\\\"\\n    \\n    # 5. Required Tags\\n    required_tags_present\\n}\\n\\n# Network security validation\\nwide_open_database_access if {\\n    sg := input.cloud_context.security_groups[_]\\n    rule := sg.ingress_rules[_]\\n    rule.cidr_blocks[_] == \\"0.0.0.0/0\\"\\n    database_port_exposed(rule.port)\\n}\\n\\n# Backup retention based on environment\\nbackup_retention_appropriate if {\\n    input.tags[\\"Environment\\"] in [\\"dev\\", \\"test\\"]\\n    input.cloud_context.backup_retention_period >= 1\\n}\\n\\nbackup_retention_appropriate if {\\n    input.tags[\\"Environment\\"] == \\"staging\\"\\n    input.cloud_context.backup_retention_period >= 7\\n}\\n\\nbackup_retention_appropriate if {\\n    input.tags[\\"Environment\\"] == \\"prod\\"\\n    input.cloud_context.backup_retention_period >= 30\\n}\\n\\n# Required tags validation\\nrequired_tags_present if {\\n    has_tag(\\"Environment\\")\\n    has_tag(\\"Owner\\")\\n    has_tag(\\"Project\\")\\n    has_tag(\\"CostCenter\\")\\n    input.tags[\\"Environment\\"] in [\\"dev\\", \\"test\\", \\"staging\\", \\"prod\\"]\\n}",
  "alert_info": "AWS RDS instance fails comprehensive security compliance checks. This may include missing encryption, public accessibility, inadequate backup configuration, outdated versions, missing required tags, or network security violations",
  "remediation_info": "Navigate to AWS RDS console|Select the non-compliant DB instance|Enable storage encryption (may require snapshot restore for existing instances)|Set publicly_accessible to false|Configure DB subnet group with private subnets|Review and restrict security group rules to remove 0.0.0.0/0 access|Set appropriate backup retention period (1+ days for dev, 7+ for staging, 30+ for prod)|Enable auto minor version upgrade|Configure maintenance window|Add required tags: Environment, Owner, Project, CostCenter|Enable Enhanced Monitoring for production instances|Configure Performance Insights for production|Enable CloudWatch log exports|Enable Multi-AZ for production instances|Enable deletion protection for production|Verify changes and test connectivity|Document all changes for compliance audit",
  "attack_types": "Data Exposure"
}
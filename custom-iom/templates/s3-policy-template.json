{
  "name": "S3 Bucket Public Access Prevention",
  "description": "Custom IOM to detect S3 buckets that allow public read or write access, ensuring data security and compliance with organizational policies",
  "platform": "AWS",
  "provider": "AWS",
  "resource_type": "AWS::S3::Bucket",
  "domain": "CSPM",
  "subdomain": "IOM",
  "severity": 1,
  "logic": "package crowdstrike\\n\\ndefault result := \\"pass\\"\\n\\n# Fail if bucket allows public read access\\nresult := \\"fail\\" if {\\n    input.cloud_context.allows_public_read == true\\n}\\n\\n# Fail if bucket allows public write access\\nresult := \\"fail\\" if {\\n    input.cloud_context.allows_public_write == true\\n}\\n\\n# Pass only if bucket is properly secured\\nresult := \\"pass\\" if {\\n    input.active == true\\n    input.cloud_context.allows_public_read == false\\n    input.cloud_context.allows_public_write == false\\n}",
  "alert_info": "S3 bucket allows public access which poses significant security risk for data exposure and unauthorized access",
  "remediation_info": "Navigate to AWS S3 console|Select the non-compliant bucket|Click Permissions tab|Review Bucket Policy and ACLs for public access grants|Remove any public read or write permissions|Enable Block Public Access settings at bucket level|Verify changes by testing access from external sources|Document changes for compliance tracking",
  "attack_types": "Data Exposure"
}